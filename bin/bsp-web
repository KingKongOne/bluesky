#! /usr/bin/env python

__author__ = "Joel Dubowy"
__copyright__ = "Copyright 2015, AirFire, PNW, USFS"

import tornado.ioloop

from pyairfire import scripting

try:
    from bluesky.web.app import main
except:
    import os
    import sys
    root_dir = os.path.abspath(os.path.join(sys.path[0], '../'))
    sys.path.insert(0, root_dir)
    from bluesky.web.app import main

# Set log format (note that loggin)
LOG_FORMAT = "%(asctime)s %(name)s %(levelname)s %(filename)s#%(funcName)s: %(message)s"

OPTIONAL_ARGS = [
    {
        'short': '-p',
        'long': '--port',
        'dest': 'port',
        'help': 'run the server listening on speciied port',
        'action': "store",
        'default': 8888
    },
    {
        'short': '-d',
        'long': '--debug',
        'dest': 'debug',
        'help': 'run the server in debug mode (with auto-reloading of code, etc.)',
        'action': "store_true",
        'default': False
    }
]

if __name__ == "__main__":
    parser, args = scripting.args.parse_args([], OPTIONAL_ARGS)
    # if not args.log_message_format:
    #     logging.basicConfig(format=format)
    main(args.port, debug=args.debug)
