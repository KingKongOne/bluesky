## Input Data

The top level input data fields that bsp recognizes are: ```run_id```,
```today```, ```config```, and ```fires```.

### 'run_id'

Run identifier. If not defined, bluesky will generate a GUID.

### 'today'

The day of the run.  Configuration settings are relative to this date.

### 'fires' Fields

The top level 'fires' array has data added to it's elements as it
moves through the pipeline of modules.  Each module has its own set of
required and optional fields that it uses, so that the set of data needed
for each fire depends on the modules to be run. Generally, the further you
are along the pipeline of modules, the more data you need.  (Note, however,
that some data required by earlier modules can be dropped when you pipe the
fire data into downstream modules.)

##### load

(no required fields)

##### ingestion

Ingestion requires that none of the fires in 'fires' are empty objects.

 - ***'fires' > 'id'*** -- *optional* -- fire's identifier
 - ***'fires' > 'type'*** -- *optional* -- fire type ('rx', 'wildfire', or 'wf' - 'wildfire' and 'wf' are equivalent); default 'wildfire'
 - ***'fires' > 'fuel_type'*** -- *optional* -- Fuel type ('natural', 'activity', or 'piles'); default 'natural'

###### 'event_of'

The following fields may be specified under a fire's "event_of" field or at
the top level, in which case the ingestion module embeds it under 'event_of'

 - ***'fires' > 'event_of' > 'name'*** -- *optional* --
 - ***'fires' > 'event_of' > 'id'*** -- *optional* -- specified as 'event_id' if at the top level

###### 'growth'

 - ***'fires' > 'growth' > 'start'*** -- *required if growth is specified* -- can be inferred from other fields
 - ***'fires' > 'growth' > 'end'*** -- *required if growth is specified* --
 - ***'fires' > 'growth' > 'localmet'*** -- *optional* -- 'localmet' is generated by an internal module (localmet); ingestion passes this on if defined
 - ***'fires' > 'growth' > 'timeprofile'*** -- *optional* -- as with 'localmet', 'timeprofile' is generated by an internal module (timeprofiling); ingestion passes this on if defined
 - ***'fires' > 'growth' > 'plumerise'*** -- *optional* -- as with 'localmet' and 'timeprofile', 'plumerise' is generated by an internal module (plumerising); ingestion passes this on if defined


If no growth objects are specified for a fire, but
the fire has 'start' and 'end' keys, a growth object will be created with
the 'start' and 'end' values


###### 'growth' > 'location'

The following fields may be specified under a fire's "location" field or at the top level, in which case the ingestion module embeds it under 'location'
The following fields may be specified within a fire growth window's "location"
object or at the top level of the fire object, in which case the ingestion
module embeds appropriately)

 - ***'fires' > 'growth' > 'location' > 'area'*** -- *required* if GeoJSON is not defined --
 - ***'fires' > 'growth' > 'location' > 'latitude'*** -- *required* if GeoJSON is not defined --
 - ***'fires' > 'growth' > 'location' > 'longitude'*** -- *required* if GeoJSON is not defined --
 - ***'fires' > 'growth' > 'location' > 'geojson'*** -- *required* if single lat/lng + area aren't defined (if GeoJSON and lat/lng+area are specified, GeoJSON data is used and lat/lng+area are ignored) -- set of coordinates defining polygon representing fire GeoJSON
 - ***'fires' > 'growth' > 'location' > 'ecoregion'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'utc_offset'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'elevation'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'slope'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'state'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'county'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'country'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'fuel_1hr'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'fuel_10hr'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'fuel_100hr'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'fuel_1khr'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'fuel_10khr'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'fuel_gt10khr'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'canopy'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'shrub'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'grass'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'rot'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'duff'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'litter'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'moisture_1hr'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'moisture_10hr'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'moisture_100hr'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'moisture_1khr'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'moisture_live'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'moisture_duff'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'min_wind'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'max_wind'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'min_wind_aloft'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'max_wind_aloft'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'min_humid'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'max_humid'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'min_temp'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'max_temp'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'min_temp_hour'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'max_temp_hour'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'sunrise_hour'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'sunset_hour'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'snow_month'*** -- *optional* --
 - ***'fires' > 'growth' > 'location' > 'rain_days'*** -- *optional* --

###### 'growth' > 'fuelbeds'

No fuelbed data is required, but ingestion will pass on any fuelbeds defined

 - ***'fires' > 'growth' > 'fuelbeds' > 'fccs_id'*** -- *optional* --
 - ***'fires' > 'growth' > 'fuelbeds' > 'pct'*** -- *optional* --
 - ***'fires' > 'growth' > 'fuelbeds' > 'fuel_loadings'*** -- *optional* --
 - ***'fires' > 'growth' > 'fuelbeds' > 'consumption'*** -- *optional* --
 - ***'fires' > 'growth' > 'fuelbeds' > 'emissions'*** -- *optional* --
 - ***'fires' > 'growth' > 'fuelbeds' > 'emissions_details'*** -- *optional* --

###### 'meta'

Any fields defined under ***'fires' > 'meta'*** are ingested as is

###### Other fields

 - ***'fires' > 'date_time'*** -- *optional* -- if defined, date_time is used to infer growth window and utc offset (if possible), which are used if not already defined for the fire

##### merge

TODO: fill in this section...

##### filter

TODO: fill in this section...

##### fuelbeds

 - ***'fires' > 'growth' > 'location'*** -- *required* -- containing either single lat/lng + area or GeoJSON data
 - ***'fires' > 'growth' > 'location' > 'state'*** -- *required* if AK -- used to determine which FCCS version to use

##### consumption

 - ***'fires' > 'growth' > 'fuelbeds'*** -- *required* -- array of fuelbeds objects, each containing 'fccs_id' and 'pct'
 - ***'fires' > 'growth' > 'location' > 'area'*** -- *required* -- fire's total area
 - ***'fires' > 'growth' > 'location' > 'ecoregion'*** -- *required*
 - ***'fires' > 'growth' > 'location' > 'fuel_moisture_1000hr_pct'*** -- *optional* -- default: 50
 - ***'fires' > 'growth' > 'location' > 'fuel_moisture_duff_pct'*** -- *optional* -- default: 50
 - ***'fires' > 'growth' > 'location' > 'fuel_moisture_litter_pct'*** -- *optional* -- default: 50
 - ***'fires' > 'growth' > 'location' > 'canopy_consumption_pct'*** -- *optional* -- default: 0
 - ***'fires' > 'growth' > 'location' > 'shrub_blackened_pct'*** -- *optional* -- default: 50
 - ***'fires' > 'growth' > 'location' > 'output_units'*** -- *optional* -- default: "tons_ac"
 - ***'fires' > 'growth' > 'location' > 'pile_blackened_pct'*** -- *optional* -- default: 0
 - ***'fires' > 'growth' > 'type'*** -- *optional* -- fire type ('rx' vs. 'wildfire'); default: 'wildfire'
 - ***'fires' > 'growth' > 'fuel_type'*** -- *optional* -- fuel type ('natural', 'activity', or 'piles'); default: 'natural'

###### if an 'rx' burn:

 - ***'fires' > 'growth' > 'location' > 'days_since_rain'*** -- *required* -- default: 1
 - ***'fires' > 'growth' > 'location' > 'length_of_ignition'*** -- *required* -- default: 1
 - ***'fires' > 'growth' > 'location' > 'slope'*** -- *optional* -- default: 5
 - ***'fires' > 'growth' > 'location' > 'windspeed'*** -- *optional* -- default: 5
 - ***'fires' > 'growth' > 'location' > 'fuel_moisture_10hr_pct'*** -- *optional* -- default: 50
 - ***'fires' > 'growth' > 'location' > 'fm_type'*** -- *optional* -- default: "MEAS-Th"

##### emissions

 - ***'fires' > 'growth' > 'fuelbeds' > 'consumption'*** -- *required* --

##### findmetdata

 - ***'fires' > 'growth'*** -- *required* if time_window isn't specified in the config -- array of growth objects, each containing 'start', 'end'

##### localmet

 - ***'met' > 'files'*** -- *required* -- array of met file objects, each containing 'first_hour', 'last_hour', and 'file' keys
 - ***'fires' > 'growth' > 'location'*** -- *required* -- fire location information containing 'utc_offset' and either single lat/lng or polygon shape data with multiple lat/lng coordinates

##### timeprofiling

 - ***'fires' > 'growth'*** -- *required* -- array of growth objects, each containing 'start' and 'end'

##### plumerising

 - ***'fires' > 'growth' > 'location' > 'area'*** -- *required* --

###### If running FEPS model

 - ***'fires' > 'growth' > 'location' > 'area'*** -- *required* --
 - ***'fires' > 'growth' > 'fuelbeds' > 'consumption'*** -- *required* --
 - ***'fires' > 'growth' > 'start'*** -- *required* --
 - ***'fires' > 'growth' > 'timeprofile'*** -- *required* --

FEPS uses a number of fire 'location' fields (listed in the ```ingestion```
section, above). All are optional, as the underlying FEPS module has built-in
defaults.

###### If running SEV model

 - ***'fires' > 'growth' > 'location' > 'area'*** -- *required* --
 - ***'fires' > 'growth' > 'localmet'*** -- *required* --
 - ***'fires' > 'growth' > 'frp'*** -- *optional* --
 - ***'fires' > 'meta' > 'frp'*** -- *optional* -- used if frp isn't defined in growth object

##### dispersion

 - ***'fires' > 'growth' > 'timeprofile'*** -- *required* --
 - ***'fires' > 'growth' > 'fuelbeds' > 'emissions'*** -- *required* --
 - ***'fires' > 'growth' > 'location' > 'utc_offset'*** -- *optional* -- hours off UTC; default: 0.0

###### if running hysplit dispersion:

- ***'met' > 'files'*** -- *required* -- array of met file objects, each containing 'first_hour', 'last_hour', and 'file' keys
  - ***'fires' > 'growth' > 'plumerise'*** -- *required* --
 - ***'met' > 'grid' > 'spacing'*** -- *required* if not specified in config (see below) --
 - ***'met' > 'grid' > 'boundary' > 'sw' > 'lat'*** -- *required* if not specified in config (see below) --
 - ***'met' > 'grid' > 'boundary' > 'sw' > 'lng'*** -- *required* if not specified in config (see below) --
 - ***'met' > 'grid' > 'boundary' > 'ne' > 'lat'*** -- *required* if not specified in config (see below) --
 - ***'met' > 'grid' > 'boundary' > 'ne' > 'lng'*** -- *required* if not specified in config (see below) --
 - ***'met' > 'grid' > 'domain'*** -- *optional* -- default: 'LatLng' (which means the spacing is in degrees)
 - ***'run_id'*** -- *optional* -- guid or other identifer to be used as output directory name; if not defined, generates new guid

###### if running vsmoke dispersion:

 - ***'fires' > 'meta' > 'vsmoke' > 'ws'*** -- *required* -- wind speed
 - ***'fires' > 'meta' > 'vsmoke' > 'wd'*** -- *required* -- wind direction
 - ***'fires' > 'meta' > 'vsmoke' > 'stability'*** -- *optional* -- stability
 - ***'fires' > 'meta' > 'vsmoke' > 'mixht'*** -- *optional* -- mixing height
 - ***'fires' > 'meta' > 'vsmoke' > 'temp'*** -- *optional* -- surface temperature
 - ***'fires' > 'meta' > 'vsmoke' > 'pressure'*** -- *optional* -- surface pressure
 - ***'fires' > 'meta' > 'vsmoke' > 'rh'*** -- *optional* -- surface relative humidity
 - ***'fires' > 'meta' > 'vsmoke' > 'sun'*** -- *optional* -- is fire during daylight hours or nighttime
 - ***'fires' > 'meta' > 'vsmoke' > 'oyinta'*** -- *optional* -- initial horizontal dispersion
 - ***'fires' > 'meta' > 'vsmoke' > 'ozinta'*** -- *optional* -- initial vertical dispersion
 - ***'fires' > 'meta' > 'vsmoke' > 'bkgpm'*** -- *optional* -- background PM 2.5
 - ***'fires' > 'meta' > 'vsmoke' > 'bkgco'*** -- *optional* -- background CO

##### visualization

###### if visualizing hysplit dispersion:

 - ***'dispersion' > 'model'*** -- *required* --
 - ***'dispersion' > 'output' > 'directory'*** -- *required* --
 - ***'dispersion' > 'output' > 'grid_filename'*** -- *required* --
 - ***'fires' > 'id'*** -- *required* --
 - ***'fires'> 'growth'  > 'location'*** -- *required* -- containing either single lat/lng + area or GeoJSON data + area
 - ***'fires' > 'type'*** -- *optional* --
 - ***'fires' > 'event_of' > 'name'*** -- *optional* --
 - ***'fires' > 'event_of' > 'id'*** -- *optional* --
 - ***'fires' > 'growth' > 'fuelbeds' > 'emissions'*** -- *optional* --
 - ***'fires' > 'growth' > 'fuelbeds' > 'fccs_id'*** -- *optional* --
 - ***'fires' > 'growth' > 'start'*** -- *required* --
 - ***'run_id'*** -- *optional* -- guid or other identifer to be used as output directory name; if not defined, generates new guid

##### export

 - ***'dispersion' > 'output'*** -- *optional* -- if 'dispersion' is in the 'extra_exports' config setting (see below), its output files will be exported along with the bsp's json output data
 - ***'visualization' > 'output'*** -- *optional* -- if 'visualization' is in the 'extra_exports' config setting (see below), its output files will be exported along with the bsp's json output data

###### if saving locally or uploading:

 - ***'run_id'*** -- *optional* -- guid or other identifer to be used as output directory name; if not defined, generates new guid

